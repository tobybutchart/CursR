var logR=new LogR;function launchExe(a){a=a.getAttribute("data-exe-type");"logs"==a?showLogModal():Modal.show(a+"-modal")}function showLogModal(){document.getElementById("logs").innerHTML=logR.toHTML(!0);Modal.show("logs-modal")}function clearLogs(){var a=document.getElementById("logs");logR.clearLogs();a&&(a.innerHTML=logR.toHTML(!0))}function downloadLogs(){logR.downloadLogs()}function openLogsInNewWindow(){logR.openLogsInNewWindow()}
var ClickPoint=Object.freeze({TopLeft:0,TopRight:1,Middle:2,Top:3}),CursR=document.querySelector("#CursR"),clickPoint=ClickPoint.TopLeft,settings=new Settings;settings.setOnStatusMessage(onSettingsStatusMessage);settings.setOnStatusWarning(onSettingsStatusWarning);var timerEnabled=!1,timer;function moveCursR(a,c,b,e){moveCursRX(a,e);moveCursRY(c,e)}
function moveCursRX(a,c){c.fitToScreen&&(0>a?(logR.log(LogType.Warning,"MAX LEFT REACHED: "+a),a=0):+a+ +CursR.offsetWidth>window.innerWidth&&(logR.log(LogType.Warning,"MAX RIGHT REACHED: "+a),a=window.innerWidth-CursR.offsetWidth));CursR.style.display="block";var b=a+"px",e=CursR.style.left,d=!1;CursR.style.left!=b&&(CursR.style.left=b,d=!0);1==d?logR.log(LogType.Debug,"Moved CursR to X: "+a+" from X: "+e):logR.log(LogType.Debug,"No X movement detected")}
function moveCursRY(a,c){c.fitToScreen&&(0>a?(logR.log(LogType.Warning,"MAX TOP REACHED: "+a),a=0):+a+ +CursR.offsetHeight>window.innerHeight&&(logR.log(LogType.Warning,"MAX BOTTOM REACHED: "+a),a=window.innerHeight-CursR.offsetHeight));CursR.style.display="block";var b=a+"px",e=CursR.style.top,d=!1;CursR.style.top!=b&&(CursR.style.top=b,d=!0);1==d?logR.log(LogType.Debug,"Moved CursR to Y: "+a+" from Y: "+e):logR.log(LogType.Debug,"No Y movement detected")}
function startTimer(){if(timerEnabled)window.clearInterval(timer),document.getElementById("btn-start-timer").innerHTML='Start Timer&nbsp;<img src="img/timer.png" alt="">';else{var a=document.getElementById("move-polling-interval").value;timer=setInterval(testMove,a);document.getElementById("btn-start-timer").innerHTML='Stop Timer&nbsp;<img src="img/timer.png" alt="">'}timerEnabled=!timerEnabled}
function startTimerFromGyro(){if(timerEnabled)window.clearInterval(timer),document.getElementById("btn-start-timer-gyro").innerHTML='Start Timer&nbsp;<img src="img/timer.png" alt="">';else{var a=document.getElementById("move-polling-interval").value;timer=setInterval(testMoveFromGyro,a);document.getElementById("btn-start-timer-gyro").innerHTML='Stop Timer&nbsp;<img src="img/timer.png" alt="">'}timerEnabled=!timerEnabled}
function testMove(){var a=document.getElementById("move-x").value,c=document.getElementById("move-y").value,b=document.getElementById("move-z").value;try{moveCursR(a,c,b,settings)}catch(e){alert(e.message)}}
function testMoveFromGyro(){var a=document.getElementById("move-alpha").value,c=document.getElementById("move-beta").value,b=document.getElementById("move-gamma").value,e=document.getElementById("move-alpha-cp").value,d=document.getElementById("move-beta-cp").value,f=document.getElementById("move-gamma-cp").value,a=alphaToX(a,e,settings.alphaMin,settings.alphaMax,settings.sensitivity),c=betaToY(c,d,settings.betaMin,settings.betaMax,settings.sensitivity);gammaToZ(b,f,settings.gammaMin,settings.gammaMax,
settings.sensitivity);try{moveCursRX(a,settings),moveCursRY(c,settings)}catch(h){alert(h.message)}}function getValueFromPercent(a,c){100<c&&(c=100);0>c&&(c=0);return c/100*a}function alphaToX(a,c,b,e,d){switch(d){case 1:d=200;break;case 2:d=300;break;default:d=100}a=rangeToLoopedArray(b,e,c,d).indexOf(Math.round(a));if(!(-1>=a))return window.innerWidth-getValueFromPercent(window.innerWidth,a)}
function betaToY(a,c,b,e,d){switch(d){case 1:d=200;break;case 2:d=300;break;default:d=100}a=rangeToLoopedArray(b,e,c,d).indexOf(Math.round(a));if(!(-1>=a))return window.innerHeight-getValueFromPercent(window.innerHeight,a)}function gammaToZ(a,c,b){return a}
function rangeToLoopedArray(a,c,b,e){a=Number(a);c=Number(c);b=Number(b);e=Number(e);for(var d=[],f=[],h=0;3>h;h++)for(var g=a;g<=c;g++)f.push(g);a=Math.round(e/2);for(g=h=c=0;g<f.length;g++)if(f[g]==Math.floor(b)&&(c++,2==c)){h=g;break}b=h-a;for(e=b+e;b<e;b++)d.push(f[b]);return d}
function onPeerDataReceived(a){try{var c=JSON.parse(a),b=alphaToX(c.alpha,c.alphaCalibrationPoint,settings.alphaMin,settings.alphaMax,settings.sensitivity),e=betaToY(c.beta,c.betaCalibrationPoint,settings.betaMin,settings.betaMax,settings.sensitivity),d=gammaToZ(c.gamma,c.gammaCalibrationPoint,settings);moveCursR(b,e,d,settings);if(c.onClickEvent||c.onDoubleClickEvent){d=a=0;switch(clickPoint){case ClickPoint.TopLeft:d=a=0;break;case ClickPoint.TopRight:a=CursR.clientWidth;d=0;break;case ClickPoint.Middle:a=
CursR.clientWidth/2;d=CursR.clientHeight/2;break;case ClickPoint.Top:a=CursR.clientWidth/2,d=0}ClickR.clickByCoordinates(+b+ +a,+e+ +d,c.onDoubleClickEvent)}}catch(f){logR.log(LogType.Error,f.message)}}function onSettingsStatusMessage(a){updateStatus("settings-modal-status",LogType.Debug,a)}function onSettingsStatusWarning(a){updateStatus("settings-modal-status",LogType.Warning,a)}
function initCursRCallbacks(){_onPeerDataReceived=onPeerDataReceived;_onConnectionClosed=_onDisconnected=hideCursR;_onDebug=function(a){logR.log(LogType.Debug,a)};_onWarning=function(a){logR.log(LogType.Warning,a)};_onError=function(a){logR.log(LogType.Error,a)};_onDebugStatusUpdate=function(a){updateStatus("cursr-modal-status",LogType.Debug,a)};_onWarningStatusUpdate=function(a){updateStatus("cursr-modal-status",LogType.Warning,a)};_onErrorStatusUpdate=function(a){updateStatus("cursr-modal-status",
LogType.Error,a)}}function connectHost(){initCursRCallbacks();initReceiver()}function hideCursR(){CursR.style.display="none"}function initConnection(){var a=document.getElementById("cursr-connection-id").value;joinPeer(a)}function sendGyroData(){sendData(movementData);movementData.onClickEvent=!1;movementData.onDoubleClickEvent=!1}
function calibrateCursR(){movementData.alphaCalibrationPoint=movementData.alpha;movementData.betaCalibrationPoint=movementData.beta;movementData.gammaCalibrationPoint=movementData.gamma}function clickCursR(){movementData.onClickEvent=!0}function doubleClickCursR(){movementData.onDoubleClickEvent=!0}
function connectCursR(){initCursRCallbacks();initSender();var a=document.getElementById("settings-polling-interval").value;initConnection();setTimeout(initConnection,1E3);calibrateCursR();setInterval(sendGyroData,a)}function disconnectCursR(){disconnectPeer()}
function testLog(){var a=document.getElementById("test-log-message").value,c=document.getElementById("test-log-type").value,b;"Debug"==c?b=LogType.Debug:"Info"==c?b=LogType.Info:"Warning"==c?b=LogType.Warning:"Error"==c&&(b=LogType.Error);try{logR.log(b,a),document.getElementById("test-log-message").value=""}catch(e){alert(e.message)}}
function testMultipleLogs(){for(var a=document.getElementById("test-log-multi-logs").value,c=0;c<a;c++){var b;switch(Math.floor(5*Math.random())){case 1:b=LogType.Debug;break;case 2:b=LogType.Info;break;case 3:b=LogType.Warning;break;case 4:b=LogType.Error;break;default:b=LogType.Debug}var e=UUID.create();try{logR.log(b,e)}catch(d){alert(d.message)}}}function updateStatus(a,c,b){a=document.getElementById(a);null!=a&&void 0!=a&&(a.innerHTML=b,a.style.color=c.colour)}
function initCursRHost(){var a=document.getElementById("cursr-host-connection-id");UUID.randomStr(3,2);a.innerHTML="cursr-123-456"}function initLabels(){document.getElementById("about-version").innerHTML=Meta.getMeta("version");document.getElementById("about-year").innerHTML=(new Date).getFullYear();document.getElementById("bios-year").innerHTML=(new Date).getFullYear()}
function initBios(a){a.bypassSplash?(document.getElementById("bios").style.display="none",document.getElementById("splash").style.display="none"):(setTimeout(function(){document.getElementById("bios-text").innerHTML+='<p class="bios-text-md">RAM.........................16mb</p>'},1E3),setTimeout(function(){document.getElementById("bios-text").innerHTML+='<p class="bios-text-md">Storage...............256mb</p>'},2E3),setTimeout(function(){document.getElementById("bios-text").innerHTML+='<p class="bios-text-md">Processor..........Intel 80486 66MHz</p>'},
3E3),setTimeout(function(){document.getElementById("bios-text").innerHTML+='<br><br><br><br><p class="bios-text-md">Sound Blaster Pro AudioPCI 250 detected</p>'},4E3),setTimeout(function(){document.getElementById("bios-text").innerHTML+='<br><br><br><br><p class="bios-text-md">Booting from tobybutchart.github.io</p>'},4500),setTimeout(function(){document.getElementById("bios").style.display="none"},5E3),setTimeout(function(){document.getElementById("splash").style.display="none"},8E3))}
function setClock(a){a.innerHTML=(new Date).toLocaleTimeString([],{timeStyle:"short"})}function initClock(){var a=document.getElementById("clock");setClock(a);setInterval(function(){setClock(a)},1E4)}document.body.addEventListener("mousemove",function(a){if("block"==document.getElementById("test-modal").style.display){var c=a.clientX;a=a.clientY;document.getElementById("cursor-x").setAttribute("value",c);document.getElementById("cursor-y").setAttribute("value",a)}});initLabels();initBios(settings);
initCursR();initCursRHost();initClock();
function changeCursR(a,c){var b;switch(a){case 0:b="&#128151;";clickPoint=ClickPoint.TopLeft;break;case 1:b="&#128310;";clickPoint=ClickPoint.Top;break;case 2:b='<img src="img/crosshair.png" alt="">';clickPoint=ClickPoint.Middle;break;case 3:b='<img src="img/laser-pointer.png" alt="">';clickPoint=ClickPoint.Middle;break;case 4:b='<img src="img/cursor-big.png" alt="">';clickPoint=ClickPoint.TopLeft;break;case 5:b="&#128169;";clickPoint=ClickPoint.Top;break;case 6:b="&#128640;";clickPoint=ClickPoint.TopRight;
break;case 7:b="&#129366;";clickPoint=ClickPoint.TopLeft;break;case 8:b="&#127814;";clickPoint=ClickPoint.TopLeft;break;default:b='<img src="img/cursor-big.png" alt="">',clickPoint=ClickPoint.TopLeft}CursR.innerHTML=b;CursR.className=c?"CursR-border":""}
function testClickRByID(){var a=document.getElementById("test-clickr-id").value,c=document.getElementById("test-clickr-double").checked,b=document.getElementById("test-clickr-close").checked;b&&Modal.hide("test-modal");ClickR.clickById(a,c);b&&Modal.show("test-modal")}
function testClickRByCoordinates(){var a=document.getElementById("test-clickr-x").value,c=document.getElementById("test-clickr-y").value,b=document.getElementById("test-clickr-double").checked,e=document.getElementById("test-clickr-close").checked;e&&Modal.hide("test-modal");ClickR.clickByCoordinates(a,c,b);e&&Modal.show("test-modal")}
function testClickRByClassName(){var a=document.getElementById("test-clickr-class").value,c=document.getElementById("test-clickr-double").checked,b=document.getElementById("test-clickr-close").checked;b&&Modal.hide("test-modal");ClickR.clickByClassName(a,c);b&&Modal.show("test-modal")}function initCursR(){changeCursR(settings.cursrType,settings.cursrBorder)}
function actionSettings(){changeCursR(settings.cursrType,settings.cursrBorder);logR.enableLogs=settings.enableLogs;logR.logToConsole=settings.logToConsole;logR.logLevel=settings.logLevel}function saveSettings(){settings.screenToSettings();settings.saveSettings();actionSettings()}function clearSettings(){settings.clearSettings();settings.settingsToScreen();actionSettings()}
var movementData={alpha:0,alphaCalibrationPoint:0,beta:0,betaCalibrationPoint:0,gamma:0,gammaCalibrationPoint:0,onClickEvent:!1,onDoubleClickEvent:!1};
function handleOrientation(a){"block"==document.getElementById("test-modal").style.display&&(null!=a.alpha&&document.getElementById("gyro-alpha").setAttribute("value",a.alpha),null!=a.beta&&document.getElementById("gyro-beta").setAttribute("value",a.beta),null!=a.gamma&&document.getElementById("gyro-gamma").setAttribute("value",a.gamma));null!=a.alpha&&(movementData.alpha=a.alpha);null!=a.beta&&(movementData.beta=a.beta);null!=a.gamma&&(movementData.gamma=a.gamma)}
function onGameUpdate(a,c,b,e){var d=document.getElementById("game-modal-status");d&&(d.innerHTML=(a?"Game Started":"Game Stopped")+" | Level: "+c+" | Score: "+b+(a?"":" | Time: "+e+"(s)"))}Modal.registerHideOnClick("start-modal");game=new Game(document,"game");game.onUpdate=onGameUpdate;
function startGame(){var a=document.getElementById("btn-start-game");game.inProgress?(game.stop(),a&&(a.innerHTML='Start&nbsp;<img src="img/start.png" alt="">')):(game.start(),a&&(a.innerHTML='Stop&nbsp;<img src="img/stop.png" alt="">'))}void 0==window.DeviceOrientationEvent?alert("no DeviceOrientationEvent"):window.addEventListener("deviceorientation",handleOrientation);
