var $jscomp={scope:{},inherits:function(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d]},checkStringArgs:function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");
return a+""}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";for(var e=b.length,f=a.length,h=Math.max(0,Math.min(c|0,b.length)),g=0;g<f&&h<e;)if(b[h++]!=a[g++])return!1;return g>=f}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;
$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return c})}},"es6","es3");
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");var BaseGameObject=function(a,b){this.document=a;this.parentID=b;this.parent=null;a&&(this.parent=this.document.getElementById(b))};BaseGameObject.prototype.clearParent=function(){this.parent&&(this.parent.innerHTML="",this.parent.onclick=null)};
var Game=function(a,b){BaseGameObject.call(this,a,b);this.inProgress=!1;this.level=1;this.misses=0;this.enemies=[];this.startTime=new Date;this.splashScreen=this.onUpdate=null;this._ENEMY_ID_BASE="____enemy-";this._PLAYING_CLASS_NAME="game-colour-change";this.clearParent();this.showSplashScreen()};$jscomp.inherits(Game,BaseGameObject);Game.prototype.enemyCount=function(){return this.enemies.length};
Game.prototype.aliveEnemyCount=function(){for(var a=0,b=0;b<this.enemies.length;b++)this.enemies[b].isDead||a++;return a};Game.prototype.deadEnemyCount=function(){var a=this.aliveEnemyCount();return+this.enemies.length-+a};Game.prototype.score=function(){return+this.deadEnemyCount()-+this.misses};Game.prototype.speed=function(){return this.level};Game.prototype.movement=function(){return 3<this.enemyCount()?50:0};
Game.prototype.showSplashScreen=function(){this.parent&&(this.parent.style.backgroundImage='url("img/emoji-sniper.jpg")',this.parent.style.backgroundPosition="center",this.parent.style.backgroundRepeat="no-repeat",this.parent.style.backgroundSize="contain",this.parent.classList.remove(this._PLAYING_CLASS_NAME))};Game.prototype.hideSplashScreen=function(){this.parent&&(this.parent.style.backgroundImage="",this.parent.classList.add(this._PLAYING_CLASS_NAME))};
Game.prototype.initParent=function(){this.clearParent();this.parent&&(this.parent.onclick=this.onCheckShot.bind(event,this))};Game.prototype.onCheckShot=function(a,b){if(a.inProgress){var c=document.elementFromPoint(Math.floor(b.clientX),Math.floor(b.clientY));c&&!c.id.startsWith(a._ENEMY_ID_BASE)&&(a.misses++,a.doOnUpdate())}};Game.prototype.onEnemyStartKill=function(a){this.inProgress&&(this.level=Math.ceil(this.enemyCount()/5),this.doOnUpdate())};
Game.prototype.onEnemyEndKill=function(a){this.inProgress&&(a=+this.level-+this.aliveEnemyCount(),this.spawnEnemies(a),this.doOnUpdate())};Game.prototype.spawnEnemies=function(a){for(var b=0;b<a;b++){var c=this._ENEMY_ID_BASE+this.enemyCount(),d=this.movement(),e=this.speed(),c=new Enemy(this.document,this.parentID,c,d,e,50-this.level);c.onStartKill=this.onEnemyStartKill.bind(this);c.onEndKill=this.onEnemyEndKill.bind(this);c.spawn();this.enemies.push(c)}};
Game.prototype.start=function(){this.inProgress||(this.level=1,this.misses=0,this.enemies=[],this.startTime=new Date,this.hideSplashScreen(),this.stop(),this.initParent(),this.spawnEnemies(1),this.inProgress=!0,game.doOnUpdate())};Game.prototype.stop=function(){if(this.inProgress){for(var a=0;a<this.enemies.length;a++)this.enemies[a].isDead||this.enemies[a].kill();this.inProgress=!1;game.doOnUpdate();this.showSplashScreen()}};
Game.prototype.doOnUpdate=function(){if("function"===typeof this.onUpdate){var a=((new Date).getTime()-this.startTime.getTime())/1E3;this.onUpdate(this.inProgress,this.level,this.score(),a)}};
var EnemyState=Object.freeze({Hover:{name:"Hover",value:-1,emojis:"&#129324; &#128557; &#128552; &#128534; &#128520; &#128127; &#128545;".split(" ")},Healthy:{name:"Healthy",value:0,emojis:["&#128578;"]},KillShot:{name:"KillShot",value:1,emojis:["&#128565;","&#129314;","&#129327;"]},DeathThrow1:{name:"DeathThrow1",value:2,emojis:["&#128128;"]},DeathThrow2:{name:"DeathThrow2",value:3,emojis:["&#128165;"]}}),EnemyStateHelper=function(){};
EnemyStateHelper.max=function(){for(var a=-1,b=Object.values(EnemyState),c=0;c<b.length;c++)b[c].value>a&&(a=b[c].value);return a};EnemyStateHelper.fromValue=function(a){for(var b=EnemyState.Healthy,c=Object.values(EnemyState),d=0;d<c.length;d++)if(c[d].value==a){b=EnemyState[c[d].name];break}return b};EnemyStateHelper.debug=function(){console.log(Object.keys(EnemyState));console.log(Object.values(EnemyState));console.log(EnemyState)};EnemyStateHelper.hoverCount=function(){return EnemyState.Hover.emojis.length};
EnemyStateHelper.deathThrowCount=function(){return EnemyState.KillShot.emojis.length};
var Enemy=function(a,b,c,d,e,f){BaseGameObject.call(this,a,b);this.enemyID=c;this.container=null;this.enemyState=EnemyState.Healthy;this.debug=!1;this.canMove=0<d;this.speed=e;this.isDead=!1;this.size=70;this.fontSize=f;this.movementTimer=null;this.movementInterval=d;this.bounceX=this.randomBounceValue();this.bounceY=this.randomBounceValue();this.movingLeft=this.movingUp=!0;this.hoverIndex=Math.floor(Math.random()*EnemyStateHelper.hoverCount());this.deathSequence=Math.floor(Math.random()*EnemyStateHelper.deathThrowCount());
this.onEndKill=this.onStartKill=null};$jscomp.inherits(Enemy,BaseGameObject);Enemy.prototype.randomBounceValue=function(){return Math.floor(10*Math.random())+1};Enemy.prototype.startXPos=function(){if(this.parent)return Math.floor(Math.random()*(this.parent.clientWidth-this.size))+"px"};Enemy.prototype.startYPos=function(){if(this.parent)return Math.floor(Math.random()*(this.parent.clientHeight-this.size))+"px"};
Enemy.prototype.spawn=function(){this.document&&this.parent&&(this.clear(),this.container=this.document.createElement("div"),this.container.id=this.enemyID,this.container.style.width=this.size+"px",this.container.style.height=this.size+"px",this.container.style.fontSize=this.fontSize+"px",this.container.style.cursor="default",this.container.style.position="absolute",this.container.style.left=this.startXPos(),this.container.style.top=this.startYPos(),this.container.style.webkitUserSelect="none",this.container.style.mozUserSelect=
"none",this.container.style.msUserSelect="none",this.container.style.oUserSelect="none",this.container.style.userSelect="none",this.debug&&(this.container.style.background="red"),this.updateFromState(EnemyState.Healthy),this.container.onclick=this.kill.bind(this),this.container.onmouseenter=this.onMouseEnter.bind(this),this.container.onmouseleave=this.onMouseLeave.bind(this),this.container.onmouseover=this.onMouseOver.bind(this),this.container.onmouseout=this.onMouseOut.bind(this),this.parent.appendChild(this.container),
this.canMove&&this.startMoveTimer())};Enemy.prototype.clear=function(){this.updateFromState(null);this.stopMoveTimer();this.container&&(this.container.remove(),this.container=null)};Enemy.prototype.onMouseOver=function(){this.isDead||this.updateFromState(EnemyState.Hover)};Enemy.prototype.onMouseOut=function(){this.isDead||this.updateFromState(EnemyState.Healthy)};Enemy.prototype.onMouseEnter=function(){};Enemy.prototype.onMouseLeave=function(){};
Enemy.prototype.updateFromState=function(a){this.enemyState=a;this.container&&(a="",this.enemyState&&(a=0,this.enemyState==EnemyState.Hover?a=this.hoverIndex:this.enemyState==EnemyState.KillShot&&(a=this.deathSequence),a=this.enemyState.emojis[a]),this.debug&&(a+=this.enemyID),this.container.innerHTML=a)};
Enemy.prototype.move=function(){if(this.canMove&&this.parent&&this.container){var a=this.container.style.left.replace("px",""),b=this.container.style.top.replace("px",""),c=a,d=b;this.movingLeft?(a=+a+ +this.bounceX+ +this.speed,a>+this.parent.clientWidth-+this.container.clientWidth?(c=Number(c)-Number(this.bounceX)-Number(this.speed),this.movingLeft=!1,this.bounceX=this.randomBounceValue()):c=a):(a=+c-+this.bounceX-+this.speed,0>a?(c=Number(c)+Number(this.bounceX)+Number(this.speed),this.movingLeft=
!0,this.bounceX=this.randomBounceValue()):c=a);this.movingUp?(b=+b+ +this.bounceY,b>+this.parent.clientHeight-+this.container.clientHeight?(d=Number(d)-Number(this.bounceY),this.movingUp=!1,this.bounceY=this.randomBounceValue()):d=b):(b=+d-+this.bounceY,0>b?(d=Number(d)+Number(this.bounceY),this.movingUp=!0,this.bounceY=this.randomBounceValue()):d=b);this.container.style.left=c+"px";this.container.style.top=d+"px"}};
Enemy.prototype.startMoveTimer=function(){this.movementTimer=setInterval(this.move.bind(this),this.movementInterval)};Enemy.prototype.stopMoveTimer=function(){clearInterval(this.movementTimer)};
Enemy.prototype.kill=function(){if(this.container&&!this.isDead){this.canMove=!1;this.isDead=!0;var a=0,b=EnemyStateHelper.max();setTimeout(this.doOnStartKill.bind(this),a);for(var c=1;c<=b;c++)this.enemyState=EnemyStateHelper.fromValue(c),setTimeout(this.updateFromState.bind(this,this.enemyState),a),a+=500;setTimeout(this.clear.bind(this),a);setTimeout(this.doOnEndKill.bind(this),a)}};Enemy.prototype.doOnStartKill=function(){if("function"===typeof this.onStartKill)this.onStartKill(this)};
Enemy.prototype.doOnEndKill=function(){if("function"===typeof this.onEndKill)this.onEndKill(this)};
